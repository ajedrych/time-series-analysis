setwd("C:/Users/aleks/WNE/time-series-analysis")
# LIBRARIES
library(readxl)
library(zoo)
library(ggplot2)
library(rcompanion)
par(mfrow=c(1,1))
################################################################################
##################### DANE NIESEZOWNOWE - REALNY KURS WALUTOWY POLSKI ##########
df <- read_excel("niesez.xls")
class(df)
is.ts(df)
#obiekt time-series
df = ts(data=df$Value, frequency = 12,
start=c(1994,1), end=c(2021,12))
dfs <- read_excel("sez.xls")
class(dfs)
is.ts(dfs)
#obiekt time-series
dfs = ts(data=dfs$Value, frequency = 12,
start=c(2004,1), end=c(2021,12))
Box.test(df, lag=24, type="Ljung-Box") #
# test Box-Pierce
Box.test(df, lag=24, type="Box-Pierce")
# test Ljung-Box
Box.test(dfs, lag=24, type="Ljung-Box") #odrzucamy H0: df to biały szum, bo p-value <0.05
# test Box-Pierce
Box.test(dfs, lag=24, type="Box-Pierce") #odrzucamy H0: df to biały szum, bo p-value <0.05
# test dickeya-fullera
library(urca)
df.test <- ur.df(df, type = c("trend"), lags = 0)
summary(df.test)
library(lmtest)
df.test.resids <- df.test@testreg$residuals #reszty
df.test.resids <- df.test@testreg$residuals #reszty
bg.df <- bgtest(df.test.resids ~ 1, order = 1) #autokorelacja 1 rzędu
bg.df
# wykres
plot(df,
type = "l",
col  = "blue",
lwd  = 2,
main = "Bladzenie przypadkowe")
# wykres
plot(df,
type = "l",
col  = "blue",
lwd  = 2,
main = "Realny kurs walutowy dla Polski")
diff.df<-diff.xts(df)
# pierwsze różnice
library(xts)
diff.df<-diff.xts(df)
# wykres
plot(diff.df,
type = "l",
col  = "blue",
lwd  = 2,
main = "Pierwsze różnice dla szeregu realnego kursu walutowego dla Polski")
# test Ljung-Box
Box.test(dfs, lag=3, type="Ljung-Box") #odrzucamy H0: dfs to biały szum, bo p-value <0.05
# test Box-Pierce
Box.test(dfs, lag=3, type="Box-Pierce") #odrzucamy H0: dfs to biały szum, bo p-value <0.05
# wykres
plot(df,
type = "l",
col  = "blue",
lwd  = 2,
main = "Realny kurs walutowy dla Polski")
url <- "http://stooq.com/q/d/l/?s=wig&i=d"
WIG <- read.csv(url,
header = TRUE,
sep = ",",
dec = ".",
stringsAsFactors = F)
WIG$Date <- as.Date(WIG$Date)
WIG <- WIG[, c("Date", "Close")]
colnames(WIG) <- c("Date", "WIG")
str(WIG)
# 2.  wykres
plot(WIG$Date, WIG$WIG, type = "l", main = "Indeks WIG")
diff.df<-diff.xts(df)
# wykres
plot(diff.df,
type = "l",
col  = "blue",
lwd  = 2,
main = "Pierwsze różnice dla szeregu realnego kursu walutowego dla Polski")
# 4. wykres
plot(WIG$Date, WIG$DWIG, type = "l", col="blue", main = "Pierwsze różnice WIG")
# 2.  wykres
plot(WIG$Date, WIG$WIG, type = "l", main = "Indeks WIG")
# 4. wykres
plot(WIG$Date, WIG$DWIG, type = "l", col="blue", main = "Pierwsze różnice WIG")
# 4. wykres
plot(WIG$Date, WIG$DWIG, type = "l", col="blue", main = "Pierwsze różnice WIG")
# 2.  wykres
plot(WIG$Date, WIG$WIG, type = "l", main = "Indeks WIG")
# 5. LAG
WIG$LWIG<-lag.xts(WIG$WIG)
plot(WIG$Date, WIG$LWIG, type = "l", col="red", main = "Indeks WIG")
# wykres
plot(df,
type = "l",
col  = "blue",
lwd  = 2,
main = "Realny kurs walutowy dla Polski")
getwd()
ln.df<-log(df)
diff.ln.df<-diff.xts(ln.df)
par(mfrow=c(1,2))
plot(diff.df,
type = "l",
col  = "blue",
lwd  = 2,
main = "Pierwsze różnice dla realnego kursu walutowego dla Polski")
plot(diff.ln.df,
type = "l",
col  = "blue",
lwd  = 2,
main = "Pierwsze różnice dla logarytmu realnego kursu walutowego dla Polski")
plot(diff.df,
type = "l",
col  = "blue",
lwd  = 2,
main = "Pierwsze różnice")
plot(diff.ln.df,
type = "l",
col  = "blue",
lwd  = 2,
main = "Pierwsze różnice dla logarytmu")
# test dickeya-fullera, pierwsza forma funkcyjna (non drift)
source("funs/TESTDF.R")
# test dickeya-fullera, pierwsza forma funkcyjna (non drift)
library(fUnitRoots)
# test dickeya-fullera, pierwsza forma funkcyjna (non drift)
install.packages("fUnitRoots")
library(fUnitRoots)
source("funs/TESTDF.R")
testdf(variable = ln.df, ADF_type="c", ADF_max_order = 5,BG_max_order = 6)
par(mfrow=c(1,1))
plot(ln.df,
type = "l",
col  = "blue",
lwd  = 2,
main = "Pierwsze różnice dla logarytmu")
testdf(variable = ln.df, ADF_type="c", ADF_max_order = 5,BG_max_order = 13)
# test KPSS
df.kpss.test <- ur.kpss(ln.df, type = c("mu"))  # stała w równaniu testowym
summary(df.kpss.test)
testdf(variable = ln.df, ADF_type="c", ADF_max_order = 5,BG_max_order = 6)
testdf(variable = ln.df, ADF_type="nc", ADF_max_order = 5,BG_max_order = 6)
testdf(variable = diff.ln.df, ADF_type="nc", ADF_max_order = 5,BG_max_order = 6)
# test KPSS
df.kpss.test <- ur.kpss(ln.df, type = c("mu"))  # stała w równaniu testowym
summary(df.kpss.test)
diff.df.kpss.test <- ur.kpss(diff.ln.df, type = c("mu"))  # stała w równaniu testowym
summary(diff.df.kpss.test)
testdf(variable = ln.df, ADF_type="nc", ADF_max_order = 5,BG_max_order = 13)
testdf(variable = diff.ln.df, ADF_type="nc", ADF_max_order = 5,BG_max_order = 13)
test <- testdf(variable = diff.ln.df, ADF_type="nc", ADF_max_order = 5,BG_max_order = 13)
stargazer(test, type = "text")
library("stargazer")
stargazer(test, type = "text")
stargazer(as.data.frame(test), type = "text")
test <- testdf(variable = diff.ln.df, ADF_type="nc", ADF_max_order = 5,BG_max_order = 13)
testdf(variable = diff.ln.df, ADF_type="nc", ADF_max_order = 5,BG_max_order = 13)
# test Ljung-Box
Box.test(diff.ln.df, lag=24, type="Ljung-Box") #odrzucamy H0: df to biały szum, bo p-value <0.05
par(mfrow = c(1, 2))
acf(diff.ln.df, lag.max = 24,
ylim = c(-1, 1),
xlim = c(1,24),
lwd = 4, col = "red")
diff.ln.df <- as.ts(diff.ln.df)
acf(diff.ln.df, lag.max = 24,
ylim = c(-1, 1),
xlim = c(1,24),
lwd = 4, col = "red")
acf(na.omit(diff.ln.df), lag.max = 24,
ylim = c(-1, 1),
xlim = c(1,24),
lwd = 4, col = "red")
acf(na.omit(diff.ln.df), lag.max = 5,
ylim = c(-1, 1),
xlim = c(1,24),
lwd = 4, col = "red")
acf(na.omit(diff.ln.df), lag.max = 24,
ylim = c(-1, 1),
xlim = c(1,5),
lwd = 4, col = "red")
acf(na.omit(diff.ln.df), lag.max = 24,
ylim = c(-1, 1),
xlim = c(1,2),
lwd = 4, col = "red")
acf(na.omit(diff.ln.df), lag.max = 24,
ylim = c(-0.2, 0.2),
xlim = c(1,3),
lwd = 4, col = "red")
pacf(na.omit(diff.ln.df), lag.max = 24,
ylim = c(-0.2, 0.2),
xlim = c(1,3),
lwd = 4, col = "red")
pacf(ln.df, lag.max = 24,
ylim = c(-0.2, 0.2),
xlim = c(1,3),
lwd = 4, col = "red")
acf(ln.df, lag.max = 24,
ylim = c(-0.2, 0.2),
xlim = c(1,3),
lwd = 4, col = "red")
acf(ln.df, lag.max = 24,
ylim = c(1, 1),
xlim = c(1,3),
lwd = 4, col = "red")
acf(ln.df, lag.max = 24,
ylim = c(-1, 1),
xlim = c(1,3),
lwd = 4, col = "red")
par(mfrow = c(1, 2))
acf(na.omit(diff.ln.df), lag.max = 24,
ylim = c(-1, 1),
xlim = c(1,3),
lwd = 4, col = "red", title="ACF")
pacf(na.omit(diff.ln.df), lag.max = 24,
ylim = c(-0.2, 0.2),
xlim = c(1,3),
lwd = 4, col = "red", title="PACF")
acf(ln.df, lag.max = 24,
ylim = c(-1, 1),
xlim = c(1,3),
lwd = 4, col = "red", title="ACF")
pacf(ln.df, lag.max = 24,
ylim = c(-0.2, 0.2),
xlim = c(1,3),
lwd = 4, col = "red", title="PACF")
acf(ln.df, lag.max = 24,
ylim = c(-1, 1),
xlim = c(1,24),
lwd = 4, col = "red", title="ACF")
acf(ln.df, lag.max = 24,
ylim = c(-1, 1),
xlim = c(1,5),
lwd = 4, col = "red", title="ACF")
acf(df, lag.max = 24,
ylim = c(-1, 1),
xlim = c(1,3),
lwd = 4, col = "red", title="ACF")
pacf(df, lag.max = 24,
ylim = c(-0.2, 0.2),
xlim = c(1,3),
lwd = 4, col = "red", title="PACF")
par(mfrow = c(1, 2))
acf(na.omit(diff.ln.df), lag.max = 24,
ylim = c(-1, 1),
xlim = c(1,3),
lwd = 4, col = "red", title="ACF")
pacf(na.omit(diff.ln.df), lag.max = 24,
ylim = c(-0.2, 0.2),
xlim = c(1,3),
lwd = 4, col = "red", title="PACF")
acf(na.omit(diff.ln.df), lag.max = 36,
ylim = c(-0.2, 0.2),
xlim = c(1,2.5),
lwd = 4, col = "red", title="ACF")
acf(na.omit(diff.ln.df), lag.max = 36,
ylim = c(-0.2, 0.2),
xlim = c(1,5),
lwd = 4, col = "red", title="ACF")
acf(na.omit(diff.ln.df),
ylim = c(-0.2, 0.2),
xlim = c(1,5),
lwd = 4, col = "red", title="ACF")
acf(na.omit(diff.ln.df),
ylim = c(-0.2, 0.2),
xlim = c(1,5),
lwd = 4, col = "red", title="ACF")
acf(na.omit(diff.ln.df), lag.max = 36
ylim = c(-0.2, 0.2),
xlim = c(1,5),
lwd = 4, col = "red", title="ACF")
acf(na.omit(diff.ln.df), lag.max = 36,
ylim = c(-0.2, 0.2),
xlim = c(1,5),
lwd = 4, col = "red")
pacf(na.omit(diff.ln.df), lag.max = 36,
ylim = c(-0.2, 0.2),
xlim = c(1,2.5),
lwd = 4, col = "red")
par(mfrow = c(1, 2))
acf(na.omit(diff.ln.df), lag.max = 36,
ylim = c(-0.2, 0.2),
xlim = c(1,4),
lwd = 4, col = "red")
pacf(na.omit(diff.ln.df), lag.max = 36,
ylim = c(-0.2, 0.2),
xlim = c(1,4),
lwd = 4, col = "red")
